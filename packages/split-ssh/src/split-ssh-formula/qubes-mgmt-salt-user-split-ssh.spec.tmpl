# vim: syntax=spec

Name:           qubes-mgmt-salt-user-split-ssh
Version:        ${VERSION}
Release:        ${RELEASE}%{?dist}
Summary:        A Salt formula that enables split-SSH in Qubes OS

License:        GPLv2
URL:            https://github.com/gonzalo-bulnes/qubes-mgmt-salt-user
Source0:        %{name}-%{version}.tar.gz

Group:          System administration tools
BuildArch:      noarch

Requires:       qubes-mgmt-salt-user-qvm-tags-in-pillar

%description
A Salt formula that enables split-SSH in Qubes OS.

%prep
%setup -q

%build
make

%install
make install DESTDIR=%{buildroot}

%files
%license LICENSE
%doc README.md CHANGELOG.md
/srv/user_salt/split-ssh

%changelog
* Thu Sep 28 2023 Gonzalo Bulnes Guilpain <gon.bulnes@fastmail.com>
- Adopt RPM configuration that works towards reproducible builds

* Fri Sep 15 2023 Gonzalo Bulnes Guilpain <gon.bulnes@fastmail.com>
- Remove workaround introduced in March 2021
- Add change log of Salt formula as documentation

* Mon Mar 01 2021 Gonzalo Bulnes Guilpain <gon.bulnes@fastmail.com>
- Ensure pillar is enabled by working around missing pillar_root for /srv/user_pillar

* Sun Feb 28 2021 Gonzalo Bulnes Guilpain <gon.bulnes@fastmail.com>
- Ensure Salt pillar is installed

* Mon Feb  8 2021 Gonzalo Bulnes Guilpain <gon.bulnes@fastmail.com>
- Initial packaging
